{"version":3,"file":"bundle.js","sources":["node_modules/riot-typed/dist/riot-typed.es.js","tags/timer.ts","tags/logger.ts","tags/error-logger.ts","tags/app.ts","app.ts"],"sourcesContent":["import { tag, util } from 'riot';\nimport * as riot from 'riot';\n\nvar DEF_KEY = '_TAG_DEF';\r\nfunction register(name, props, target) {\r\n    var def = util.misc.extend({}, target[DEF_KEY], props);\r\n    target[DEF_KEY] = def;\r\n    tag(name, def.tmpl || '', def.css, def.attrs, function (opts) {\n        var this$1 = this;\n\r\n        var obj = Object.create(target.prototype);\r\n        var init = obj.init;\r\n        if (typeof init !== 'undefined') {\r\n            // recovery original init property when mixin\r\n            obj.init = function () { return this$1.init = typeof init === 'function' ? init.bind(this$1) : init; };\r\n        }\r\n        this.mixin(obj); //copy properties so the next line would not complain\r\n        target.call(this, opts); //call constructor\r\n    });\r\n}\r\n/**\r\n* decorator on class that extends Tag.\r\n* that defines a riot tag with template and the class.\r\n* see riot.tag()\r\n*/\r\nfunction tag$1(name, tmpl) {\r\n    return function (target) {\r\n        // target is the constructor function\r\n        if (typeof tmpl === 'object') {\r\n            register(name, tmpl, target);\r\n        }\r\n        else {\r\n            register(name, { tmpl: tmpl }, target);\r\n        }\r\n    };\r\n}\r\n/**\r\n   riot tag\r\n  */\r\nvar Tag = function Tag () {};\n\nexport { tag$1 as tag, Tag };\n","import {tag, Tag} from 'riot-typed';\n\nexport interface TimerOpts {\n  initial: number;\n}\n\nlet timerCount = 0;\n\n@tag('timer', `\n<p>timer {id} - { count }</p>\n`)\nexport default class Timer extends Tag<TimerOpts> {\n  id = ++timerCount;\n  count: number = 0;\n  timerId: number;\n  constructor() {\n    super();\n    this.on('mount', () => {\n      console.log(`${this.id} timer mounted`, this.opts);\n      this.count = this.opts.initial;\n\n      this.timerId = setInterval(() => {\n        this.count++;\n        this.update();\n        console.log(`${this.id} updating`);\n      }, 1000);\n    });\n\n    this.on('unmount', ()=>{\n      if (this.timerId) {\n        clearInterval(this.timerId);\n        this.timerId = null;\n      }\n      console.log(`${this.id} timer unmounted`, this.opts);\n    })\n  }\n}\n","import {tag, Tag} from 'riot-typed';\r\n\r\n@tag('logger',{ tmpl: '<p class=\"color\" each=\"{ item in logs }\">{ item }</p>', css: '.color{color:gray;}' })\r\nexport default class Logger extends Tag<any>{\r\n    logs: string[];\r\n\r\n    constructor(){\r\n        super();\r\n\r\n        this.logs = ['line 1', 'line 2'];\r\n    }\r\n}","import * as riot from 'riot';\nimport {tag, Tag} from 'riot-typed';\n\nimport Logger from './logger'\n\n//example of override css\n\n@tag('error-logger',{ css: 'error-logger .color{color:red;}' })\nexport default class ErrorLogger extends Logger{\n    constructor(){\n        super();\n\n        this.logs.push('!!!Error!!!');\n    }\n}","import {mount as mnt} from 'riot';\nimport {tag, Tag} from 'riot-typed';\n\nimport {TimerOpts } from  './timer';\nimport './timer'; //import timer so that timer tag can be mounted\nimport './logger';\nimport './error-logger'\n\ntype AppOpts = { title: string };\n\nconst TAG_NAME = 'app';\n@tag(TAG_NAME, `\n<h1>{title}</h1>\n<p><b>Total timers:</b> {timers.length}</p>\n<timer each=\"{ item in timers }\" initial=\"{item.initial}\"></timer>\n<logger></logger>\n<error-logger></error-logger>\n`)\nexport default class App extends Tag<AppOpts> {\n  timers: TimerOpts[];\n  title: string;\n\n  private timerId: number;\n  constructor() {\n    super();\n\n    console.log('in App constructor');\n    // this.title = 'Hello RiotJS';\n\n    this.timers = [];\n\n    this.on('mount', () => {\n      console.log('app mounted');\n      this.title = this.opts.title;\n      this.refill();\n      this.update();\n\n      this.timerId = setInterval(this.refill, 3000);\n    });\n\n    this.on('unmount', ()=>{\n      if (this.timerId) {\n        clearInterval(this.timerId);\n        this.timerId = null;\n      }\n    });\n\n    this.init();\n  }\n\n  init(){\n    console.log('in init');\n  }\n\n  refill() {\n    if (this.timers.length === 0) {\n      for (let i = 0; i < 10; i++) {\n        this.timers.push({\n          initial: i * 15\n        });\n      }\n    } else {\n      this.timers.pop();\n      this.update();\n    }\n  }\n\n  static mount(opts: AppOpts) {\n    mnt(TAG_NAME, opts);\n  }\n}\n","import App from './tags/app';\n\nApp.mount({title : 'Hello riot-typed'});\nconsole.log('==ready==');\n"],"names":["util","tag","let","super","this","const","mnt"],"mappings":";;;AAGA,IAAI,OAAO,GAAG,UAAU,CAAC;AACzB,SAAS,QAAQ,CAAC,IAAI,EAAE,KAAK,EAAE,MAAM,EAAE;IACnC,IAAI,GAAG,GAAGA,SAAI,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE,EAAE,MAAM,CAAC,OAAO,CAAC,EAAE,KAAK,CAAC,CAAC;IACvD,MAAM,CAAC,OAAO,CAAC,GAAG,GAAG,CAAC;IACtBC,QAAG,CAAC,IAAI,EAAE,GAAG,CAAC,IAAI,IAAI,EAAE,EAAE,GAAG,CAAC,GAAG,EAAE,GAAG,CAAC,KAAK,EAAE,UAAU,IAAI,EAAE;QAC1D,IAAI,MAAM,GAAG,IAAI,CAAC;;QAElB,IAAI,GAAG,GAAG,MAAM,CAAC,MAAM,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;QAC1C,IAAI,IAAI,GAAG,GAAG,CAAC,IAAI,CAAC;QACpB,IAAI,OAAO,IAAI,KAAK,WAAW,EAAE;;YAE7B,GAAG,CAAC,IAAI,GAAG,YAAY,EAAE,OAAO,MAAM,CAAC,IAAI,GAAG,OAAO,IAAI,KAAK,UAAU,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,GAAG,IAAI,CAAC,EAAE,CAAC;SAC1G;QACD,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;QAChB,MAAM,CAAC,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;KAC3B,CAAC,CAAC;CACN;;;;;;AAMD,SAAS,KAAK,CAAC,IAAI,EAAE,IAAI,EAAE;IACvB,OAAO,UAAU,MAAM,EAAE;;QAErB,IAAI,OAAO,IAAI,KAAK,QAAQ,EAAE;YAC1B,QAAQ,CAAC,IAAI,EAAE,IAAI,EAAE,MAAM,CAAC,CAAC;SAChC;aACI;YACD,QAAQ,CAAC,IAAI,EAAE,EAAE,IAAI,EAAE,IAAI,EAAE,EAAE,MAAM,CAAC,CAAC;SAC1C;KACJ,CAAC;CACL;;;;AAID,IAAI,GAAG,GAAG,SAAS,GAAG,IAAI,EAAE,CAAC,AAE7B,AAA6B;;;;;;;;;;;;;ACnC7BC,IAAI,UAAU,GAAG,CAAC,CAAC;AAKJA,IAAM,KAAK;IAAX;;;QAKXC,MAAK,KAAA,MAAE,CAAC;QAJV,OAAE,GAAG,EAAE,UAAU,CAAC;QAClB,UAAK,GAAW,CAAC,CAAC;QAIhB,IAAI,CAAC,EAAE,CAAC,OAAO,EAAE;YACf,OAAO,CAAC,GAAG,EAAC,CAAGC,MAAI,CAAC,EAAE,uBAAkBA,MAAI,CAAC,IAAI,CAAC,CAAC;YACnDA,MAAI,CAAC,KAAK,GAAGA,MAAI,CAAC,IAAI,CAAC,OAAO,CAAC;YAE/BA,MAAI,CAAC,OAAO,GAAG,WAAW,CAAC;gBACzBA,MAAI,CAAC,KAAK,EAAE,CAAC;gBACbA,MAAI,CAAC,MAAM,EAAE,CAAC;gBACd,OAAO,CAAC,GAAG,EAAC,CAAGA,MAAI,CAAC,EAAE,iBAAY,CAAC;aACpC,EAAE,IAAI,CAAC,CAAC;SACV,CAAC,CAAC;QAEH,IAAI,CAAC,EAAE,CAAC,SAAS,EAAE;YACjB,IAAIA,MAAI,CAAC,OAAO,EAAE;gBAChB,aAAa,CAACA,MAAI,CAAC,OAAO,CAAC,CAAC;gBAC5BA,MAAI,CAAC,OAAO,GAAG,IAAI,CAAC;aACrB;YACD,OAAO,CAAC,GAAG,EAAC,CAAGA,MAAI,CAAC,EAAE,yBAAoBA,MAAI,CAAC,IAAI,CAAC,CAAC;SACtD,CAAC,CAAA;KACH;;;;wCAAA;;;EAxBgC,GAyBlC,EAAA,CAAA;AAzBoB,KAAK;IAHzBH,KAAG,CAAC,OAAO,EAAE,oCAEZ;;GACmB,KAAK,CAyBzB,CAED;;ACnCeC,IAAM,MAAM;IAAZ;QAIPC,MAAK,KAAA,MAAE,CAAC;QAER,IAAI,CAAC,IAAI,GAAG,CAAC,QAAQ,EAAE,QAAQ,CAAC,CAAC;KACpC;;;;0CAAA;;;EAP+B,GAQnC,EAAA,CAAA;AARoB,MAAM;IAD1BF,KAAG,CAAC,QAAQ,EAAC,EAAE,IAAI,EAAE,uDAAuD,EAAE,GAAG,EAAE,qBAAqB,EAAE,CAAC;;GACvF,MAAM,CAQ1B,CACD;;;ACJeC,IAAM,WAAW;IAAjB;QAEPC,SAAK,KAAA,MAAE,CAAC;QAER,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;KACjC;;;;oDAAA;;;EALoC,MAMxC,EAAA,CAAA;AANoB,WAAW;IAD/BF,KAAG,CAAC,cAAc,EAAC,EAAE,GAAG,EAAE,iCAAiC,EAAE,CAAC;;GAC1C,WAAW,CAM/B,CACD;;ACLAI,IAAM,QAAQ,GAAG,KAAK,CAAC;AAQRH,IAAM,GAAG;IAAT;;;QAMXC,MAAK,KAAA,MAAE,CAAC;QAER,OAAO,CAAC,GAAG,CAAC,oBAAoB,CAAC,CAAC;;QAGlC,IAAI,CAAC,MAAM,GAAG,EAAE,CAAC;QAEjB,IAAI,CAAC,EAAE,CAAC,OAAO,EAAE;YACf,OAAO,CAAC,GAAG,CAAC,aAAa,CAAC,CAAC;YAC3BC,MAAI,CAAC,KAAK,GAAGA,MAAI,CAAC,IAAI,CAAC,KAAK,CAAC;YAC7BA,MAAI,CAAC,MAAM,EAAE,CAAC;YACdA,MAAI,CAAC,MAAM,EAAE,CAAC;YAEdA,MAAI,CAAC,OAAO,GAAG,WAAW,CAACA,MAAI,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;SAC/C,CAAC,CAAC;QAEH,IAAI,CAAC,EAAE,CAAC,SAAS,EAAE;YACjB,IAAIA,MAAI,CAAC,OAAO,EAAE;gBAChB,aAAa,CAACA,MAAI,CAAC,OAAO,CAAC,CAAC;gBAC5BA,MAAI,CAAC,OAAO,GAAG,IAAI,CAAC;aACrB;SACF,CAAC,CAAC;QAEH,IAAI,CAAC,IAAI,EAAE,CAAC;KACb;;;;oCAAA;IAED,cAAA,IAAI;QACF,OAAO,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC;KACxB,CAAA;IAED,cAAA,MAAM;;;QACJ,IAAI,IAAI,CAAC,MAAM,CAAC,MAAM,KAAK,CAAC,EAAE;YAC5B,KAAKF,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,EAAE,EAAE,CAAC,EAAE,EAAE;gBAC3BE,MAAI,CAAC,MAAM,CAAC,IAAI,CAAC;oBACf,OAAO,EAAE,CAAC,GAAG,EAAE;iBAChB,CAAC,CAAC;aACJ;SACF;aAAM;YACL,IAAI,CAAC,MAAM,CAAC,GAAG,EAAE,CAAC;YAClB,IAAI,CAAC,MAAM,EAAE,CAAC;SACf;KACF,CAAA;IAED,IAAA,KAAY,sBAAC,IAAa;QACxBE,UAAG,CAAC,QAAQ,EAAE,IAAI,CAAC,CAAC;KACrB,CAAA;;;EAnD8B,GAoDhC,EAAA,CAAA;AApDoB,GAAG;IAPvBL,KAAG,CAAC,QAAQ,EAAE,8LAMb;;GACmB,GAAG,CAoDvB,CAED;;ACtEA,GAAG,CAAC,KAAK,CAAC,EAAC,KAAK,EAAG,kBAAkB,EAAC,CAAC,CAAC;AACxC,OAAO,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC;;"}